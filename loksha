//
//  FetchViewModel.swift
//  flashCardApp
//
//  Created by karim hamed ashour on 10/10/24.
//

import UIKit

class FetchViewModel: NSObject {
    var quizes : Quizes?
    var i = 0
    var links=["https://opentdb.com/api.php?amount=10&category=21","https://opentdb.com/api.php?amount=10&category=27","https://opentdb.com/api.php?amount=10&category=23","https://opentdb.com/api.php?amount=10&category=25","https://opentdb.com/api.php?amount=10&category=19","https://opentdb.com/api.php?amount=10&category=11"]
    func fetchQuiz() -> [Quiz] {
        // Define the URL for the GitHub API
        for link in links{
            let token =
            let url = URL(string: link)!
            
            // Define the headers for the request
            var request = URLRequest(url: url, cachePolicy: .useProtocolCachePolicy)
            request.httpMethod = "GET"
            request.setValue("Bearer \(token)", forHTTPHeaderField: "Authorization")
            
            // Make the request
            let task = URLSession.shared.dataTask(with: request) { data, response, error in
                if let error = error {
                    print("Error making request: \(error)")
                    return
                }
                
                guard let data = data else {
                    print("No data returned")
                    return
                }
                
                
                
                // Parse the JSON data
                do {
                    let quizes = try JSONDecoder().decode(Quizes.self, from: data)
                    self.quizes![1]
                    
                } catch {
                    print("Error parsing JSON: \(error)")
                }
            }
            
            // Handle the response
            task.resume()
        }
        print("\(quizes)")
        return quizes
    }
}
